<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Процедуры и функции взаимодействия с системой | OneScript.Web - документация</title>
    <meta name="description" content="Документация по объектам os.web">
    
    
    <link rel="preload" href="/assets/css/styles.47aefa7a.css" as="style"><link rel="preload" href="/assets/js/app.47aefa7a.js" as="script"><link rel="preload" href="/assets/js/8.8eb98eac.js" as="script"><link rel="prefetch" href="/assets/js/15.6f9f490a.js"><link rel="prefetch" href="/assets/css/1.styles.5a8ea794.css"><link rel="prefetch" href="/assets/js/1.5a8ea794.js"><link rel="prefetch" href="/assets/css/2.styles.89488626.css"><link rel="prefetch" href="/assets/js/2.89488626.js"><link rel="prefetch" href="/assets/js/3.0e519eb3.js"><link rel="prefetch" href="/assets/js/4.d439f458.js"><link rel="prefetch" href="/assets/js/5.1a6e7c2b.js"><link rel="prefetch" href="/assets/js/6.2c682c3b.js"><link rel="prefetch" href="/assets/js/7.6b313e69.js"><link rel="prefetch" href="/assets/js/9.c064453d.js"><link rel="prefetch" href="/assets/js/10.57c1b5b6.js"><link rel="prefetch" href="/assets/js/11.40ae93f6.js"><link rel="prefetch" href="/assets/js/12.8d02b43d.js"><link rel="prefetch" href="/assets/js/13.5e70039d.js"><link rel="prefetch" href="/assets/js/14.989b0482.js"><link rel="prefetch" href="/assets/js/16.90e2f094.js"><link rel="prefetch" href="/assets/js/17.44ebcaef.js"><link rel="prefetch" href="/assets/js/18.b7625c29.js"><link rel="prefetch" href="/assets/js/19.ee860382.js"><link rel="prefetch" href="/assets/js/20.c700fc25.js"><link rel="prefetch" href="/assets/js/21.f255db73.js"><link rel="prefetch" href="/assets/js/22.87d70127.js"><link rel="prefetch" href="/assets/js/23.8d3df72a.js"><link rel="prefetch" href="/assets/js/24.d7c4ce2d.js"><link rel="prefetch" href="/assets/js/25.7eeb3164.js"><link rel="prefetch" href="/assets/js/26.340483f8.js"><link rel="prefetch" href="/assets/js/27.d762a9b6.js"><link rel="prefetch" href="/assets/js/28.a4c06574.js"><link rel="prefetch" href="/assets/js/29.eaa6b129.js"><link rel="prefetch" href="/assets/js/30.639cb276.js"><link rel="prefetch" href="/assets/js/31.7360b711.js"><link rel="prefetch" href="/assets/js/32.9b5f8ebd.js"><link rel="prefetch" href="/assets/js/33.5cc0030f.js"><link rel="prefetch" href="/assets/js/34.af60ab25.js">
    <link rel="stylesheet" href="/assets/css/1.styles.5a8ea794.css"><link rel="stylesheet" href="/assets/css/2.styles.89488626.css"><link rel="stylesheet" href="/assets/css/styles.47aefa7a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">OneScript.Web - документация</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">Введение</a></li><li><a href="/syntax/" class="sidebar-link">Синтакс-помощник</a></li><li><a href="/docs/app-structure.html" class="sidebar-link">Структура приложения</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="процедуры-и-функции-взаимодействия-с-системой"><a href="#процедуры-и-функции-взаимодействия-с-системой" aria-hidden="true" class="header-anchor">#</a> Процедуры и функции взаимодействия с системой</h1> <p>Глобальный контекст. Представляет глобально доступные свойства и методы.</p> <h2 id="свойства"><a href="#свойства" aria-hidden="true" class="header-anchor">#</a> Свойства</h2> <h3 id="файnовыепотоки-filestreams"><a href="#файnовыепотоки-filestreams" aria-hidden="true" class="header-anchor">#</a> ФайловыеПотоки / FileStreams</h3> <p>Доступ: Чтение</p> <p>Менеджер файловых потоков.</p> <h3 id="симвоnы-chars"><a href="#симвоnы-chars" aria-hidden="true" class="header-anchor">#</a> Символы / Chars</h3> <p>Доступ: Чтение</p> <p>Содержит набор системных символов.</p> <h2 id="методы"><a href="#методы" aria-hidden="true" class="header-anchor">#</a> Методы</h2> <h3 id="сообщить-message"><a href="#сообщить-message" aria-hidden="true" class="header-anchor">#</a> Сообщить / Message()</h3> <p>Выдает сообщение в консоль.</p> <h4 id="параметры"><a href="#параметры" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><p><em>message</em>: Выдаваемое сообщение.</p></li> <li><p><em>status</em>: Статус сообщения. В зависимости от статуса изменяется цвет вывода сообщения.</p></li></ul> <h3 id="подкnючитьсценарий-attachscript"><a href="#подкnючитьсценарий-attachscript" aria-hidden="true" class="header-anchor">#</a> ПодключитьСценарий / AttachScript()</h3> <p>Подключает сторонний файл сценария к текущей системе типов.
Подключенный сценарий выступает, как самостоятельный класс, создаваемый оператором Новый</p> <h4 id="пример"><a href="#пример" aria-hidden="true" class="header-anchor">#</a> Пример:</h4> <pre><code>ПодключитьСценарий(&quot;C:\file.os&quot;, &quot;МойОбъект&quot;);
А = Новый МойОбъект();
</code></pre> <h4 id="параметры-2"><a href="#параметры-2" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><p><em>path</em>: Путь к подключаемому сценарию</p></li> <li><p><em>typeName</em>: Имя типа, которое будет иметь новый класс. Экземпляры класса создаются оператором Новый.</p></li></ul> <h3 id="загрузитьсценарийизстроки-loadscriptfromstring"><a href="#загрузитьсценарийизстроки-loadscriptfromstring" aria-hidden="true" class="header-anchor">#</a> ЗагрузитьСценарийИзСтроки / LoadScriptFromString()</h3> <p>Создает экземпляр объекта на основании стороннего файла сценария.
Загруженный сценарий возвращается, как самостоятельный объект.
Экспортные свойства и методы скрипта доступны для вызова.</p> <h4 id="пример-2"><a href="#пример-2" aria-hidden="true" class="header-anchor">#</a> Пример:</h4> <pre><code>Контекст = Новый Структура(&quot;ЧислоПи&quot;, 3.1415); // 4 знака хватит всем
ЗагрузитьСценарийИзСтроки(&quot;Сообщить(ЧислоПи);&quot;, Контекст);
</code></pre> <h4 id="параметры-3"><a href="#параметры-3" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><p><em>code</em>: Текст сценария</p></li> <li><p><em>externalContext</em>: Структура. Глобальные свойства, которые будут инжектированы в область видимости загружаемого скрипта. (Необязательный)</p></li></ul> <h3 id="загрузитьсценарий-loadscript"><a href="#загрузитьсценарий-loadscript" aria-hidden="true" class="header-anchor">#</a> ЗагрузитьСценарий / LoadScript()</h3> <p>Создает экземпляр объекта на основании стороннего файла сценария.
Загруженный сценарий возвращается, как самостоятельный объект.
Экспортные свойства и методы скрипта доступны для вызова.</p> <h4 id="пример-3"><a href="#пример-3" aria-hidden="true" class="header-anchor">#</a> Пример:</h4> <pre><code>Контекст = Новый Структура(&quot;ЧислоПи&quot;, 3.1415); // 4 знака хватит
// В коде скрипта somescript.os будет доступна глобальная переменная &quot;ЧислоПи&quot;
Объект = ЗагрузитьСценарий(&quot;somescript.os&quot;, Контекст);
</code></pre> <h4 id="параметры-4"><a href="#параметры-4" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><p><em>path</em>: Путь к подключаемому сценарию</p></li> <li><p><em>externalContext</em>: Структура. Глобальные свойства, которые будут инжектированы в область видимости загружаемого скрипта. (Необязательный)</p></li></ul> <h3 id="подкnючитьвнешнююкомпоненту-attachaddin"><a href="#подкnючитьвнешнююкомпоненту-attachaddin" aria-hidden="true" class="header-anchor">#</a> ПодключитьВнешнююКомпоненту / AttachAddIn()</h3> <p>Подключает внешнюю сборку среды .NET (*.dll) и регистрирует классы 1Script, объявленные в этой сборке.
Публичные классы, отмеченные в dll атрибутом ContextClass, будут импортированы аналогично встроенным классам 1Script.
Загружаемая сборка должна ссылаться на сборку ScriptEngine.dll</p> <h4 id="пример-4"><a href="#пример-4" aria-hidden="true" class="header-anchor">#</a> Пример:</h4> <pre><code>ПодключитьВнешнююКомпоненту(&quot;C:\MyAssembly.dll&quot;);
КлассИзКомпоненты = Новый КлассИзКомпоненты(); // тип объявлен внутри компоненты
</code></pre> <h4 id="параметры-5"><a href="#параметры-5" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><em>dllPath</em>: Путь к внешней компоненте</li></ul> <h3 id="стартовыйсценарий-entryscript"><a href="#стартовыйсценарий-entryscript" aria-hidden="true" class="header-anchor">#</a> СтартовыйСценарий / EntryScript()</h3> <p>Возвращает информацию о сценарии, который был точкой входа в программу.
Можно выделить два вида сценариев: те, которые были подключены, как классы и те, которые запущены непосредственно. Метод СтартовыйСценарий возвращает информацию о сценарии, запущенном непосредственно.
Для получения информации о текущем выполняемом сценарии см. метод ТекущийСценарий()</p> <h4 id="возвращаемое-значение"><a href="#возвращаемое-значение" aria-hidden="true" class="header-anchor">#</a> Возвращаемое значение</h4> <p>Объект ИнформацияОСценарии</p> <h3 id="приостановить-sleep"><a href="#приостановить-sleep" aria-hidden="true" class="header-anchor">#</a> Приостановить / Sleep()</h3> <p>Приостанавливает выполнение скрипта.</p> <h4 id="параметры-6"><a href="#параметры-6" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><em>delay</em>: Время приостановки в миллисекундах</li></ul> <h3 id="освободитьобъект-freeobject"><a href="#освободитьобъект-freeobject" aria-hidden="true" class="header-anchor">#</a> ОсвободитьОбъект / FreeObject()</h3> <p>Явное освобождение ресурса через интерфейс IDisposable среды CLR.</p> <p>OneScript не выполняет подсчет ссылок на объекты, а полагается на сборщик мусора CLR.
Это значит, что объекты автоматически не освобождаются при выходе из области видимости.</p> <p>Метод ОсвободитьОбъект можно использовать для детерминированного освобождения ресурсов. Если объект поддерживает интерфейс IDisposable, то данный метод вызовет Dispose у данного объекта.</p> <p>Как правило, интерфейс IDisposable реализуется различными ресурсами (файлами, соединениями с ИБ и т.п.)</p> <h4 id="параметры-7"><a href="#параметры-7" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><em>obj</em>: Объект, ресурсы которого требуется освободить.</li></ul> <h3 id="выпоnнитьсборкумусора-rungarbagecollection"><a href="#выпоnнитьсборкумусора-rungarbagecollection" aria-hidden="true" class="header-anchor">#</a> ВыполнитьСборкуМусора / RunGarbageCollection()</h3> <p>OneScript не выполняет подсчет ссылок на объекты, а полагается на сборщик мусора CLR.
Это значит, что объекты автоматически не освобождаются при выходе из области видимости.</p> <p>С помощью данного метода можно запустить принудительную сборку мусора среды CLR.
Данные метод следует использовать обдуманно, поскольку вызов данного метода не гарантирует освобождение всех объектов.
Локальные переменные, например, до завершения текущего метода очищены не будут,
поскольку до завершения текущего метода CLR будет видеть, что они используются движком 1Script.</p> <h3 id="запуститьприnожение-runapp"><a href="#запуститьприnожение-runapp" aria-hidden="true" class="header-anchor">#</a> ЗапуститьПриложение / RunApp()</h3> <p>Запуск приложения в операционной системе</p> <h4 id="параметры-8"><a href="#параметры-8" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><p><em>cmdLine</em>: Командная строка запуска</p></li> <li><p><em>currentDir</em>: Текущая директория запускаемого процесса (необязательно)</p></li> <li><p><em>wait</em>: Ожидать завершения (необязательно) по умолчанию Ложь</p></li> <li><p><em>retCode</em>: Выходной параметр. Код возврата процесса. Имеет смысл только если указан параметр wait=true</p></li></ul> <h3 id="создатьпроцесс-createprocess"><a href="#создатьпроцесс-createprocess" aria-hidden="true" class="header-anchor">#</a> СоздатьПроцесс / CreateProcess()</h3> <p>Создает процесс, которым можно манипулировать из скрипта</p> <h4 id="параметры-9"><a href="#параметры-9" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><p><em>cmdLine</em>: Командная строка запуска</p></li> <li><p><em>currentDir</em>: Текущая директория запускаемого процесса (необязательно)</p></li> <li><p><em>redirectOutput</em>: Перехватывать стандартные потоки stdout и stderr</p></li> <li><p><em>redirectInput</em>: Перехватывать стандартный поток stdin</p></li> <li><p><em>encoding</em>: Кодировка стандартных потоков вывода и ошибок</p></li> <li><p><em>env</em>: Соответствие, где установлены значения переменных среды</p></li></ul> <h3 id="найтипроцесспоидентификатору-findprocessbyid"><a href="#найтипроцесспоидентификатору-findprocessbyid" aria-hidden="true" class="header-anchor">#</a> НайтиПроцессПоИдентификатору / FindProcessById()</h3> <p>Выполняет поиск процесса по PID среди запущенных в операционной системе</p> <h4 id="параметры-10"><a href="#параметры-10" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><em>PID</em>: Идентификатор процесса</li></ul> <h4 id="возвращаемое-значение-2"><a href="#возвращаемое-значение-2" aria-hidden="true" class="header-anchor">#</a> Возвращаемое значение</h4> <p>Процесс. Если не найден - Неопределено</p> <h3 id="найтипроцессыпоимени-findprocessesbyname"><a href="#найтипроцессыпоимени-findprocessesbyname" aria-hidden="true" class="header-anchor">#</a> НайтиПроцессыПоИмени / FindProcessesByName()</h3> <p>Выполняет поиск процессов с определенным именем</p> <h4 id="параметры-11"><a href="#параметры-11" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><em>name</em>: Имя процесса</li></ul> <h4 id="возвращаемое-значение-3"><a href="#возвращаемое-значение-3" aria-hidden="true" class="header-anchor">#</a> Возвращаемое значение</h4> <p>Массив объектов Процесс.</p> <h3 id="катаnогпрограммы-programdirectory"><a href="#катаnогпрограммы-programdirectory" aria-hidden="true" class="header-anchor">#</a> КаталогПрограммы / ProgramDirectory()</h3> <p>Каталог исполняемых файлов OneScript</p> <h4 id="возвращаемое-значение-4"><a href="#возвращаемое-значение-4" aria-hidden="true" class="header-anchor">#</a> Возвращаемое значение</h4> <h3 id="краткоепредставnениеошибки-brieferrordescription"><a href="#краткоепредставnениеошибки-brieferrordescription" aria-hidden="true" class="header-anchor">#</a> КраткоеПредставлениеОшибки / BriefErrorDescription()</h3> <h3 id="подробноепредставnениеошибки-detailerrordescription"><a href="#подробноепредставnениеошибки-detailerrordescription" aria-hidden="true" class="header-anchor">#</a> ПодробноеПредставлениеОшибки / DetailErrorDescription()</h3> <h3 id="текущаядата-currentdate"><a href="#текущаядата-currentdate" aria-hidden="true" class="header-anchor">#</a> ТекущаяДата / CurrentDate()</h3> <p>Текущая дата машины</p> <h4 id="возвращаемое-значение-5"><a href="#возвращаемое-значение-5" aria-hidden="true" class="header-anchor">#</a> Возвращаемое значение</h4> <p>Дата</p> <h3 id="текущаяуниверсаnьнаядатавмиnnисекундах-currentuniversaldateinmilliseconds"><a href="#текущаяуниверсаnьнаядатавмиnnисекундах-currentuniversaldateinmilliseconds" aria-hidden="true" class="header-anchor">#</a> ТекущаяУниверсальнаяДатаВМиллисекундах / CurrentUniversalDateInMilliseconds()</h3> <h3 id="значениезапоnнено-valueisfilled"><a href="#значениезапоnнено-valueisfilled" aria-hidden="true" class="header-anchor">#</a> ЗначениеЗаполнено / ValueIsFilled()</h3> <p>Проверяет заполненность значения по принципу, заложенному в 1С:Предприятии</p> <h4 id="параметры-12"><a href="#параметры-12" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><em>inValue</em>:</li></ul> <h4 id="возвращаемое-значение-6"><a href="#возвращаемое-значение-6" aria-hidden="true" class="header-anchor">#</a> Возвращаемое значение</h4> <h3 id="isvaluefilled-isvaluefilled"><a href="#isvaluefilled-isvaluefilled" aria-hidden="true" class="header-anchor">#</a> IsValueFilled / IsValueFilled()</h3> <h3 id="запоnнитьзначениясвойств-fillpropertyvalues"><a href="#запоnнитьзначениясвойств-fillpropertyvalues" aria-hidden="true" class="header-anchor">#</a> ЗаполнитьЗначенияСвойств / FillPropertyValues()</h3> <p>Заполняет одноименные значения свойств одного объекта из другого</p> <h4 id="параметры-13"><a href="#параметры-13" aria-hidden="true" class="header-anchor">#</a> Параметры</h4> <ul><li><p><em>acceptor</em>: Объект-приемник</p></li> <li><p><em>source</em>: Объект-источник</p></li> <li><p><em>filledProperties</em>: Заполняемые свойства (строка, через запятую)</p></li> <li><p><em>ignoredProperties</em>: Игнорируемые свойства (строка, через запятую)</p></li></ul></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/8.8eb98eac.js" defer></script><script src="/assets/js/app.47aefa7a.js" defer></script>
  </body>
</html>
